import{a as x,j as s,w as f,K as g,v as h}from"./ui-J8zN8ojh.js";import{d as w,u as j}from"./vendor-DK4z8uX1.js";import{u as v}from"./usersService-B0l8xTxg.js";import{u as b,B as n}from"./index-DNpSr7TS.js";import{I as c}from"./input-p9w5ixzj.js";import{L as u}from"./label-BwTpjIUa.js";import{u as y}from"./useDocumentTitle-mo0ffS8w.js";function q(){const{id:d}=w(),i=j(),{user:l}=b();y("שינוי סיסמה");const[e,m]=x.useState({password:"",confirmPassword:"",isLoading:!1,error:"",success:!1}),t=d||l?.id,r=a=>{m(o=>({...o,...a}))},p=async a=>{if(a.preventDefault(),!!t){if(r({error:"",success:!1}),e.password!==e.confirmPassword){r({error:"הסיסמאות אינן תואמות"});return}if(e.password.length<6){r({error:"הסיסמה חייבת להיות באורך של לפחות 6 תווים"});return}r({isLoading:!0});try{await v.updateUser(t,{password:e.password}),r({success:!0}),setTimeout(()=>{i(-1)},2e3)}catch(o){r({error:o.message||"שגיאה בשינוי הסיסמה"})}finally{r({isLoading:!1})}}};return t?s.jsx("div",{className:"max-w-md mx-auto py-12 px-4",children:s.jsxs("div",{className:"bg-card border rounded-lg p-6 shadow-sm",children:[s.jsx("h1",{className:"text-2xl font-bold mb-2",children:"שינוי סיסמה"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:d?"הגדר סיסמה חדשה עבור המשתמש":"הגדר סיסמה חדשה עבור החשבון שלך"}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.error&&s.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-destructive/15 dark:bg-destructive/25 p-3 text-sm text-destructive dark:text-destructive-foreground",children:[s.jsx(f,{size:18}),s.jsx("span",{children:e.error})]}),e.success&&s.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-green-500/15 dark:bg-green-500/25 p-3 text-sm text-green-600 dark:text-green-400",children:[s.jsx(g,{size:18}),s.jsx("span",{children:"הסיסמה שונתה בהצלחה! חוזר..."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(u,{htmlFor:"password",children:"סיסמה חדשה"}),s.jsx(c,{id:"password",type:"password",value:e.password,onChange:a=>r({password:a.target.value}),required:!0,autoComplete:"new-password"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(u,{htmlFor:"confirmPassword",children:"אימות סיסמה"}),s.jsx(c,{id:"confirmPassword",type:"password",value:e.confirmPassword,onChange:a=>r({confirmPassword:a.target.value}),required:!0,autoComplete:"new-password"})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[s.jsx(n,{type:"button",variant:"outline",onClick:()=>i(-1),disabled:e.isLoading,children:"ביטול"}),s.jsxs(n,{type:"submit",disabled:e.isLoading||e.success,children:[e.isLoading&&s.jsx(h,{className:"ml-2 h-4 w-4 animate-spin"}),"שנה סיסמה"]})]})]})]})}):null}export{q as default};
