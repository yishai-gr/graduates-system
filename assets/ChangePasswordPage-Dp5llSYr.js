import{j as e,p as y,Q as N,o as S}from"./ui-BdsuqOTa.js";import{i as P,u as C,r}from"./vendor-CxWUHsYF.js";import{u as I}from"./usersService-DJPz4FzW.js";import{u as k,B as p}from"./index-i34jhlcz.js";import{I as f}from"./input-DADBOwxQ.js";import{L as h}from"./label-BllYq0t9.js";function B(){const{id:i}=P(),o=C(),{user:g}=k(),[t,j]=r.useState(""),[c,v]=r.useState(""),[n,u]=r.useState(!1),[l,a]=r.useState(""),[m,x]=r.useState(!1),d=i||g?.id,b=async s=>{if(s.preventDefault(),!!d){if(a(""),x(!1),t!==c){a("הסיסמאות אינן תואמות");return}if(t.length<6){a("הסיסמה חייבת להיות באורך של לפחות 6 תווים");return}u(!0);try{await I.updateUser(d,{password:t}),x(!0),setTimeout(()=>{o(-1)},2e3)}catch(w){a(w.message||"שגיאה בשינוי הסיסמה")}finally{u(!1)}}};return d?e.jsx("div",{className:"max-w-md mx-auto py-12 px-4",children:e.jsxs("div",{className:"bg-card border rounded-lg p-6 shadow-sm",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"שינוי סיסמה"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:i?"הגדר סיסמה חדשה עבור המשתמש":"הגדר סיסמה חדשה עבור החשבון שלך"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[l&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-destructive/15 dark:bg-destructive/25 p-3 text-sm text-destructive dark:text-destructive-foreground",children:[e.jsx(y,{size:18}),e.jsx("span",{children:l})]}),m&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-green-500/15 dark:bg-green-500/25 p-3 text-sm text-green-600 dark:text-green-400",children:[e.jsx(N,{size:18}),e.jsx("span",{children:"הסיסמה שונתה בהצלחה! חוזר..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"סיסמה חדשה"}),e.jsx(f,{id:"password",type:"password",value:t,onChange:s=>j(s.target.value),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"confirmPassword",children:"אימות סיסמה"}),e.jsx(f,{id:"confirmPassword",type:"password",value:c,onChange:s=>v(s.target.value),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>o(-1),disabled:n,children:"ביטול"}),e.jsxs(p,{type:"submit",disabled:n||m,children:[n&&e.jsx(S,{className:"ml-2 h-4 w-4 animate-spin"}),"שנה סיסמה"]})]})]})]})}):null}export{B as default};
